#include "myutils.h"
#include "features.h"
#include "dss.h"

// Freqs AA/20
static float Freqs_AA[20] = {
   0.081053f,
   0.013989f,
   0.057990f,
   0.070191f,
   0.040391f,
   0.072408f,
   0.023216f,
   0.057991f,
   0.059277f,
   0.094527f,
   0.017958f,
   0.041622f,
   0.046079f,
   0.037216f,
   0.052758f,
   0.059484f,
   0.053736f,
   0.071781f,
   0.013693f,
   0.034642f };

// Freqs NbrDist/16
static float Freqs_NbrDist[16] = {
   0.053605f,
   0.051742f,
   0.051096f,
   0.052109f,
   0.053606f,
   0.055746f,
   0.060282f,
   0.062136f,
   0.061794f,
   0.061931f,
   0.061731f,
   0.062851f,
   0.064271f,
   0.065907f,
   0.072345f,
   0.108846f };

// Freqs MySS/16
static float Freqs_MySS[16] = {
   0.270353f,
   0.107096f,
   0.084089f,
   0.051954f,
   0.051163f,
   0.048313f,
   0.046750f,
   0.045154f,
   0.043377f,
   0.041906f,
   0.041519f,
   0.042631f,
   0.035407f,
   0.032071f,
   0.031482f,
   0.026736f };

// Freqs NbrMySS/16
static float Freqs_NbrMySS[16] = {
   0.220077f,
   0.139949f,
   0.129379f,
   0.061022f,
   0.040259f,
   0.053470f,
   0.038375f,
   0.036814f,
   0.026336f,
   0.044509f,
   0.042476f,
   0.036842f,
   0.035511f,
   0.038386f,
   0.031057f,
   0.025539f };

// Freqs RevNbrDist/16
static float Freqs_RevNbrDist[16] = {
   0.050040f,
   0.026371f,
   0.044586f,
   0.070471f,
   0.098372f,
   0.234389f,
   0.065342f,
   0.053976f,
   0.046884f,
   0.040206f,
   0.033792f,
   0.030481f,
   0.027747f,
   0.026339f,
   0.034545f,
   0.116460f };

// Freqs DstNxtHlx/16
static float Freqs_DstNxtHlx[16] = {
   0.327013f,
   0.003260f,
   0.006039f,
   0.010993f,
   0.017459f,
   0.024919f,
   0.029890f,
   0.034812f,
   0.039629f,
   0.046173f,
   0.043129f,
   0.073294f,
   0.065466f,
   0.104032f,
   0.069177f,
   0.104715f };

// Freqs StrandDens/16
static float Freqs_StrandDens[16] = {
   0.096288f,
   0.096320f,
   0.068715f,
   0.058490f,
   0.054377f,
   0.052562f,
   0.052088f,
   0.052514f,
   0.053356f,
   0.055008f,
   0.057039f,
   0.059644f,
   0.060077f,
   0.059084f,
   0.057764f,
   0.066675f };

// Freqs NormDens/16
static float Freqs_NormDens[16] = {
   0.108003f,
   0.076361f,
   0.069455f,
   0.065213f,
   0.062921f,
   0.061204f,
   0.059333f,
   0.057394f,
   0.056333f,
   0.054970f,
   0.054102f,
   0.054157f,
   0.053031f,
   0.052306f,
   0.051494f,
   0.063724f };

static double FreqMx_AA[20][20] = {
  {     0.016,   0.00141,   0.00355,   0.00502,   0.00287,   0.00586,   0.00163,   0.00472,    0.0043,   0.00778,   0.00166,   0.00267,   0.00298,   0.00278,   0.00374,   0.00529,   0.00433,   0.00703,   0.00094,   0.00243,  }, // 0
  {   0.00141,   0.00351,  0.000349,  0.000404,  0.000525,  0.000655,   0.00023,  0.000782,  0.000406,   0.00121,   0.00024,  0.000349,  0.000324,  0.000284,  0.000407,  0.000697,  0.000631,   0.00119,  0.000133,  0.000402,  }, // 1
  {   0.00355,  0.000349,    0.0111,   0.00537,   0.00105,   0.00371,   0.00129,   0.00137,   0.00329,   0.00242,  0.000592,   0.00325,   0.00228,    0.0023,   0.00269,   0.00369,   0.00285,   0.00185,   0.00045,   0.00114,  }, // 2
  {   0.00502,  0.000404,   0.00537,     0.011,   0.00138,   0.00351,   0.00155,   0.00193,   0.00504,   0.00341,  0.000793,   0.00277,   0.00262,   0.00361,   0.00408,   0.00407,   0.00347,   0.00274,  0.000551,   0.00151,  }, // 3
  {   0.00287,  0.000525,   0.00105,   0.00138,   0.00599,   0.00155,  0.000892,   0.00336,   0.00125,   0.00589,   0.00097,  0.000968,   0.00106,  0.000934,   0.00131,   0.00156,   0.00166,   0.00369,   0.00106,     0.003,  }, // 4
  {   0.00586,  0.000655,   0.00371,   0.00351,   0.00155,    0.0227,    0.0013,   0.00186,   0.00316,   0.00317,  0.000791,   0.00312,   0.00262,   0.00196,   0.00266,   0.00447,   0.00292,   0.00276,  0.000561,   0.00147,  }, // 5
  {   0.00163,   0.00023,   0.00129,   0.00155,  0.000892,    0.0013,   0.00289,  0.000895,   0.00138,   0.00158,  0.000349,   0.00117,  0.000762,   0.00099,   0.00135,    0.0014,   0.00121,   0.00121,  0.000337,   0.00116,  }, // 6
  {   0.00472,  0.000782,   0.00137,   0.00193,   0.00336,   0.00186,  0.000895,    0.0104,    0.0019,    0.0105,    0.0016,   0.00114,   0.00152,   0.00131,   0.00186,   0.00202,   0.00258,   0.00964,  0.000752,   0.00202,  }, // 7
  {    0.0043,  0.000406,   0.00329,   0.00504,   0.00125,   0.00316,   0.00138,    0.0019,   0.00825,   0.00335,  0.000811,   0.00252,   0.00228,   0.00299,   0.00481,    0.0035,   0.00304,   0.00266,  0.000483,   0.00141,  }, // 8
  {   0.00778,   0.00121,   0.00242,   0.00341,   0.00589,   0.00317,   0.00158,    0.0105,   0.00335,    0.0234,   0.00284,   0.00204,   0.00252,   0.00232,   0.00326,   0.00339,   0.00383,    0.0108,   0.00144,   0.00349,  }, // 9
  {   0.00166,   0.00024,  0.000592,  0.000793,   0.00097,  0.000791,  0.000349,    0.0016,  0.000811,   0.00284,  0.000935,  0.000506,  0.000534,  0.000582,  0.000739,  0.000833,  0.000881,   0.00174,  0.000259,  0.000673,  }, // 10
  {   0.00267,  0.000349,   0.00325,   0.00277,  0.000968,   0.00312,   0.00117,   0.00114,   0.00252,   0.00204,  0.000506,   0.00491,    0.0016,    0.0017,   0.00214,   0.00294,   0.00232,   0.00162,  0.000376,   0.00109,  }, // 11
  {   0.00298,  0.000324,   0.00228,   0.00262,   0.00106,   0.00262,  0.000762,   0.00152,   0.00228,   0.00252,  0.000534,    0.0016,   0.00853,   0.00129,   0.00184,   0.00262,   0.00211,   0.00214,   0.00036,  0.000988,  }, // 12
  {   0.00278,  0.000284,    0.0023,   0.00361,  0.000934,   0.00196,   0.00099,   0.00131,   0.00299,   0.00232,  0.000582,    0.0017,   0.00129,    0.0029,   0.00258,   0.00236,   0.00204,   0.00173,  0.000369,   0.00101,  }, // 13
  {   0.00374,  0.000407,   0.00269,   0.00408,   0.00131,   0.00266,   0.00135,   0.00186,   0.00481,   0.00326,  0.000739,   0.00214,   0.00184,   0.00258,   0.00735,   0.00309,   0.00279,    0.0025,  0.000541,   0.00149,  }, // 14
  {   0.00529,  0.000697,   0.00369,   0.00407,   0.00156,   0.00447,    0.0014,   0.00202,    0.0035,   0.00339,  0.000833,   0.00294,   0.00262,   0.00236,   0.00309,   0.00715,   0.00461,   0.00294,  0.000579,   0.00158,  }, // 15
  {   0.00433,  0.000631,   0.00285,   0.00347,   0.00166,   0.00292,   0.00121,   0.00258,   0.00304,   0.00383,  0.000881,   0.00232,   0.00211,   0.00204,   0.00279,   0.00461,   0.00688,   0.00392,  0.000587,   0.00154,  }, // 16
  {   0.00703,   0.00119,   0.00185,   0.00274,   0.00369,   0.00276,   0.00121,   0.00964,   0.00266,    0.0108,   0.00174,   0.00162,   0.00214,   0.00173,    0.0025,   0.00294,   0.00392,    0.0146,  0.000932,   0.00247,  }, // 17
  {   0.00094,  0.000133,   0.00045,  0.000551,   0.00106,  0.000561,  0.000337,  0.000752,  0.000483,   0.00144,  0.000259,  0.000376,   0.00036,  0.000369,  0.000541,  0.000579,  0.000587,  0.000932,   0.00284,  0.000984,  }, // 18
  {   0.00243,  0.000402,   0.00114,   0.00151,     0.003,   0.00147,   0.00116,   0.00202,   0.00141,   0.00349,  0.000673,   0.00109,  0.000988,   0.00101,   0.00149,   0.00158,   0.00154,   0.00247,  0.000984,   0.00528,  }, // 19
};

static double FreqMx_NbrDist[16][16] = {
  {    0.0199,    0.0126,   0.00737,   0.00508,   0.00389,   0.00313,   0.00243,   0.00172,   0.00131,   0.00111,   0.00096,  0.000824,  0.000748,  0.000658,  0.000442,  0.000331,  }, // 0
  {    0.0126,    0.0147,    0.0118,   0.00731,   0.00448,   0.00302,   0.00205,   0.00134,   0.00105,  0.000852,  0.000791,  0.000679,  0.000623,  0.000563,  0.000347,  0.000277,  }, // 1
  {   0.00737,    0.0118,    0.0143,    0.0102,   0.00593,   0.00363,   0.00227,   0.00146,   0.00118,   0.00099,  0.000834,  0.000695,  0.000621,  0.000595,   0.00037,  0.000313,  }, // 2
  {   0.00508,   0.00731,    0.0102,    0.0116,   0.00935,   0.00611,    0.0035,   0.00211,    0.0016,   0.00133,   0.00113,  0.000922,  0.000773,  0.000736,  0.000522,  0.000378,  }, // 3
  {   0.00389,   0.00448,   0.00593,   0.00935,    0.0117,   0.00947,   0.00503,   0.00293,   0.00227,   0.00176,   0.00146,   0.00122,   0.00103,  0.000895,  0.000653,  0.000455,  }, // 4
  {   0.00313,   0.00302,   0.00363,   0.00611,   0.00947,    0.0117,   0.00756,   0.00438,   0.00327,   0.00251,     0.002,   0.00166,   0.00135,   0.00114,  0.000889,  0.000587,  }, // 5
  {   0.00243,   0.00205,   0.00227,    0.0035,   0.00503,   0.00756,   0.00955,    0.0077,   0.00576,   0.00451,   0.00352,   0.00266,   0.00206,   0.00165,   0.00128,  0.000911,  }, // 6
  {   0.00172,   0.00134,   0.00146,   0.00211,   0.00293,   0.00438,    0.0077,   0.00966,   0.00825,   0.00649,   0.00493,    0.0037,   0.00276,   0.00222,   0.00174,   0.00114,  }, // 7
  {   0.00131,   0.00105,   0.00118,    0.0016,   0.00227,   0.00327,   0.00576,   0.00825,   0.00935,    0.0081,   0.00629,   0.00462,   0.00349,   0.00265,     0.002,   0.00124,  }, // 8
  {   0.00111,  0.000852,   0.00099,   0.00133,   0.00176,   0.00251,   0.00451,   0.00649,    0.0081,   0.00921,   0.00808,   0.00607,   0.00439,   0.00327,   0.00256,   0.00142,  }, // 9
  {   0.00096,  0.000791,  0.000834,   0.00113,   0.00146,     0.002,   0.00352,   0.00493,   0.00629,   0.00808,   0.00908,   0.00797,   0.00585,   0.00441,   0.00336,   0.00179,  }, // 10
  {  0.000824,  0.000679,  0.000695,  0.000922,   0.00122,   0.00166,   0.00266,    0.0037,   0.00462,   0.00607,   0.00797,   0.00946,   0.00839,   0.00638,   0.00476,   0.00243,  }, // 11
  {  0.000748,  0.000623,  0.000621,  0.000773,   0.00103,   0.00135,   0.00206,   0.00276,   0.00349,   0.00439,   0.00585,   0.00839,    0.0106,   0.00955,   0.00689,   0.00336,  }, // 12
  {  0.000658,  0.000563,  0.000595,  0.000736,  0.000895,   0.00114,   0.00165,   0.00222,   0.00265,   0.00327,   0.00441,   0.00638,   0.00955,    0.0124,    0.0104,   0.00498,  }, // 13
  {  0.000442,  0.000347,   0.00037,  0.000522,  0.000653,  0.000889,   0.00128,   0.00174,     0.002,   0.00256,   0.00336,   0.00476,   0.00689,    0.0104,    0.0162,    0.0101,  }, // 14
  {  0.000331,  0.000277,  0.000313,  0.000378,  0.000455,  0.000587,  0.000911,   0.00114,   0.00124,   0.00142,   0.00179,   0.00243,   0.00336,   0.00498,    0.0101,    0.0326,  }, // 15
};

static double FreqMx_MySS[16][16] = {
  {     0.235,   0.00379,   0.00189,   0.00212,   0.00358,   0.00188,   0.00297,   0.00907,   0.00499,   0.00407,   0.00191,    0.0113,   0.00299,   0.00154,   0.00136,   0.00107,  }, // 0
  {   0.00379,    0.0546,    0.0226,   0.00756,   0.00246,   0.00826,   0.00204,  0.000513,  0.000708,   0.00113,   0.00753,  0.000758,   0.00049,   0.00169,  0.000876,  0.000718,  }, // 1
  {   0.00189,    0.0226,    0.0615,    0.0019,   0.00114,   0.00427,  0.000768,   0.00015,    0.0002,  0.000346,   0.00207,  0.000217,  0.000204,  0.000467,  0.000275,  0.000188,  }, // 2
  {   0.00212,   0.00756,    0.0019,    0.0187,   0.00374,     0.004,   0.00144,  0.000677,  0.000973,  0.000854,   0.00229,  0.000929,  0.000605,   0.00293,     0.002,  0.000387,  }, // 3
  {   0.00358,   0.00246,   0.00114,   0.00374,     0.018,   0.00412,   0.00146,  0.000623,    0.0037,  0.000734,   0.00112,   0.00188,   0.00153,   0.00143,   0.00199,   0.00058,  }, // 4
  {   0.00188,   0.00826,   0.00427,     0.004,   0.00412,    0.0196,   0.00099,  0.000328,  0.000874,  0.000452,   0.00154,  0.000781,  0.000595,  0.000883,   0.00091,  0.000287,  }, // 5
  {   0.00297,   0.00204,  0.000768,   0.00144,   0.00146,   0.00099,    0.0195,  0.000954,    0.0022,    0.0026,   0.00435,  0.000669,  0.000582,   0.00171,   0.00128,  0.000926,  }, // 6
  {   0.00907,  0.000513,   0.00015,  0.000677,  0.000623,  0.000328,  0.000954,    0.0204,  0.000868,   0.00165,  0.000518,   0.00121,  0.000414,  0.000826,  0.000906,  0.000772,  }, // 7
  {   0.00499,  0.000708,    0.0002,  0.000973,    0.0037,  0.000874,    0.0022,  0.000868,    0.0139,    0.0015,  0.000759,   0.00163,   0.00293,  0.000747,   0.00156,   0.00137,  }, // 8
  {   0.00407,   0.00113,  0.000346,  0.000854,  0.000734,  0.000452,    0.0026,   0.00165,    0.0015,    0.0168,   0.00106,  0.000567,  0.000469,   0.00206,  0.000851,   0.00259,  }, // 9
  {   0.00191,   0.00753,   0.00207,   0.00229,   0.00112,   0.00154,   0.00435,  0.000518,  0.000759,   0.00106,     0.016,  0.000469,  0.000303,    0.0015,  0.000723,  0.000587,  }, // 10
  {    0.0113,  0.000758,  0.000217,  0.000929,   0.00188,  0.000781,  0.000669,   0.00121,   0.00163,  0.000567,  0.000469,    0.0114,   0.00142,  0.000932,    0.0011,    0.0003,  }, // 11
  {   0.00299,   0.00049,  0.000204,  0.000605,   0.00153,  0.000595,  0.000582,  0.000414,   0.00293,  0.000469,  0.000303,   0.00142,    0.0149,  0.000417,   0.00146,   0.00149,  }, // 12
  {   0.00154,   0.00169,  0.000467,   0.00293,   0.00143,  0.000883,   0.00171,  0.000826,  0.000747,   0.00206,    0.0015,  0.000932,  0.000417,   0.00979,    0.0013,  0.000579,  }, // 13
  {   0.00136,  0.000876,  0.000275,     0.002,   0.00199,   0.00091,   0.00128,  0.000906,   0.00156,  0.000851,  0.000723,    0.0011,   0.00146,    0.0013,   0.00901,  0.000759,  }, // 14
  {   0.00107,  0.000718,  0.000188,  0.000387,   0.00058,  0.000287,  0.000926,  0.000772,   0.00137,   0.00259,  0.000587,    0.0003,   0.00149,  0.000579,  0.000759,   0.00981,  }, // 15
};

static double FreqMx_NbrMySS[16][16] = {
  {      0.14,    0.0109,   0.00899,   0.00516,   0.00385,   0.00386,    0.0031,   0.00797,   0.00372,    0.0067,   0.00316,   0.00779,   0.00555,   0.00356,   0.00304,   0.00291,  }, // 0
  {    0.0109,    0.0584,    0.0324,   0.00963,   0.00353,   0.00972,   0.00345,   0.00146,   0.00138,   0.00301,   0.00822,   0.00187,   0.00193,   0.00361,   0.00209,   0.00158,  }, // 1
  {   0.00899,    0.0324,    0.0784,   0.00455,   0.00263,   0.00719,   0.00216,  0.000977,   0.00092,   0.00226,   0.00379,   0.00115,   0.00146,   0.00195,   0.00128,   0.00107,  }, // 2
  {   0.00516,   0.00963,   0.00455,    0.0179,   0.00348,    0.0045,   0.00184,   0.00095,   0.00117,   0.00153,   0.00285,   0.00132,   0.00145,   0.00366,   0.00244,  0.000817,  }, // 3
  {   0.00385,   0.00353,   0.00263,   0.00348,   0.00822,   0.00323,   0.00119,  0.000595,   0.00145,  0.000979,   0.00107,   0.00127,   0.00155,   0.00121,   0.00165,  0.000594,  }, // 4
  {   0.00386,   0.00972,   0.00719,    0.0045,   0.00323,    0.0154,    0.0012,  0.000562,  0.000889,   0.00105,    0.0018,  0.000952,  0.000946,   0.00127,   0.00125,  0.000603,  }, // 5
  {    0.0031,   0.00345,   0.00216,   0.00184,   0.00119,    0.0012,    0.0108,  0.000929,  0.000899,   0.00263,   0.00326,  0.000704,  0.000856,   0.00195,   0.00104,   0.00114,  }, // 6
  {   0.00797,   0.00146,  0.000977,   0.00095,  0.000595,  0.000562,  0.000929,    0.0085,  0.000702,   0.00204,  0.000665,   0.00104,   0.00088,  0.000929,  0.000799,  0.000877,  }, // 7
  {   0.00372,   0.00138,   0.00092,   0.00117,   0.00145,  0.000889,  0.000899,  0.000702,   0.00349,    0.0009,  0.000639,  0.000996,   0.00172,  0.000712,  0.000916,  0.000743,  }, // 8
  {    0.0067,   0.00301,   0.00226,   0.00153,  0.000979,   0.00105,   0.00263,   0.00204,    0.0009,    0.0127,   0.00147,   0.00101,  0.000933,   0.00239,    0.0011,   0.00205,  }, // 9
  {   0.00316,   0.00822,   0.00379,   0.00285,   0.00107,    0.0018,   0.00326,  0.000665,  0.000639,   0.00147,    0.0118,  0.000612,  0.000584,   0.00202,  0.000841,  0.000762,  }, // 10
  {   0.00779,   0.00187,   0.00115,   0.00132,   0.00127,  0.000952,  0.000704,   0.00104,  0.000996,   0.00101,  0.000612,    0.0062,   0.00128,  0.000966,   0.00091,  0.000477,  }, // 11
  {   0.00555,   0.00193,   0.00146,   0.00145,   0.00155,  0.000946,  0.000856,   0.00088,   0.00172,  0.000933,  0.000584,   0.00128,    0.0102,  0.000747,   0.00139,   0.00108,  }, // 12
  {   0.00356,   0.00361,   0.00195,   0.00366,   0.00121,   0.00127,   0.00195,  0.000929,  0.000712,   0.00239,   0.00202,  0.000966,  0.000747,   0.00872,    0.0019,  0.000921,  }, // 13
  {   0.00304,   0.00209,   0.00128,   0.00244,   0.00165,   0.00125,   0.00104,  0.000799,  0.000916,    0.0011,  0.000841,   0.00091,   0.00139,    0.0019,   0.00535,   0.00081,  }, // 14
  {   0.00291,   0.00158,   0.00107,  0.000817,  0.000594,  0.000603,   0.00114,  0.000877,  0.000743,   0.00205,  0.000762,  0.000477,   0.00108,  0.000921,   0.00081,   0.00552,  }, // 15
};

static double FreqMx_RevNbrDist[16][16] = {
  {    0.0462,   0.00605,   0.00316,   0.00245,   0.00219,   0.00147,  0.000602,  0.000434,  0.000346,  0.000259,  0.000184,   0.00013,  9.02e-05,  7.25e-05,   7.6e-05,   0.00032,  }, // 0
  {   0.00605,   0.00785,   0.00606,   0.00359,   0.00247,   0.00152,  0.000751,  0.000479,  0.000356,  0.000229,  0.000161,  0.000113,  7.96e-05,   7.4e-05,  6.78e-05,  0.000268,  }, // 1
  {   0.00316,   0.00606,    0.0132,    0.0107,   0.00675,    0.0038,   0.00181,   0.00104,   0.00072,  0.000465,  0.000314,  0.000256,  0.000172,  0.000127,  0.000145,  0.000436,  }, // 2
  {   0.00245,   0.00359,    0.0107,    0.0216,    0.0182,   0.00912,   0.00406,   0.00229,   0.00143,  0.000926,  0.000605,  0.000449,  0.000314,  0.000259,  0.000252,  0.000731,  }, // 3
  {   0.00219,   0.00247,   0.00675,    0.0182,    0.0377,    0.0201,   0.00874,    0.0046,   0.00263,   0.00158,   0.00101,  0.000712,  0.000518,  0.000398,  0.000373,   0.00111,  }, // 4
  {   0.00147,   0.00152,    0.0038,   0.00912,    0.0201,     0.131,    0.0153,   0.00807,   0.00482,   0.00347,   0.00266,   0.00241,   0.00217,   0.00232,    0.0033,    0.0183,  }, // 5
  {  0.000602,  0.000751,   0.00181,   0.00406,   0.00874,    0.0153,    0.0159,    0.0103,   0.00511,   0.00263,   0.00153,  0.000944,  0.000685,  0.000517,  0.000436,   0.00118,  }, // 6
  {  0.000434,  0.000479,   0.00104,   0.00229,    0.0046,   0.00807,    0.0103,    0.0117,   0.00759,   0.00387,   0.00201,   0.00125,  0.000824,  0.000555,  0.000487,   0.00119,  }, // 7
  {  0.000346,  0.000356,   0.00072,   0.00143,   0.00263,   0.00482,   0.00511,   0.00759,   0.00916,   0.00597,   0.00306,    0.0017,   0.00106,  0.000707,  0.000599,   0.00126,  }, // 8
  {  0.000259,  0.000229,  0.000465,  0.000926,   0.00158,   0.00347,   0.00263,   0.00387,   0.00597,   0.00709,   0.00448,   0.00254,   0.00149,  0.000954,  0.000738,   0.00147,  }, // 9
  {  0.000184,  0.000161,  0.000314,  0.000605,   0.00101,   0.00266,   0.00153,   0.00201,   0.00306,   0.00448,   0.00498,   0.00372,   0.00211,   0.00133,  0.000972,    0.0018,  }, // 10
  {   0.00013,  0.000113,  0.000256,  0.000449,  0.000712,   0.00241,  0.000944,   0.00125,    0.0017,   0.00254,   0.00372,   0.00442,   0.00307,   0.00189,   0.00131,   0.00224,  }, // 11
  {  9.02e-05,  7.96e-05,  0.000172,  0.000314,  0.000518,   0.00217,  0.000685,  0.000824,   0.00106,   0.00149,   0.00211,   0.00307,   0.00346,   0.00283,   0.00184,    0.0029,  }, // 12
  {  7.25e-05,   7.4e-05,  0.000127,  0.000259,  0.000398,   0.00232,  0.000517,  0.000555,  0.000707,  0.000954,   0.00133,   0.00189,   0.00283,   0.00359,   0.00303,   0.00411,  }, // 13
  {   7.6e-05,  6.78e-05,  0.000145,  0.000252,  0.000373,    0.0033,  0.000436,  0.000487,  0.000599,  0.000738,  0.000972,   0.00131,   0.00184,   0.00303,   0.00635,   0.00894,  }, // 14
  {   0.00032,  0.000268,  0.000436,  0.000731,   0.00111,    0.0183,   0.00118,   0.00119,   0.00126,   0.00147,    0.0018,   0.00224,    0.0029,   0.00411,   0.00894,    0.0494,  }, // 15
};

static double FreqMx_DstNxtHlx[16][16] = {
  {      0.27,  0.000307,  0.000431,  0.000649,   0.00094,   0.00127,   0.00155,   0.00182,   0.00201,   0.00287,   0.00242,   0.00383,   0.00357,   0.00629,   0.00472,   0.00734,  }, // 0
  {  0.000307,  0.000499,  0.000454,  0.000384,    0.0004,  0.000406,  0.000293,  0.000197,  0.000129,  9.71e-05,  7.53e-05,  9.61e-05,  7.35e-05,  0.000107,  6.53e-05,  7.68e-05,  }, // 1
  {  0.000431,  0.000454,  0.000875,  0.000942,   0.00079,  0.000772,  0.000655,  0.000499,  0.000308,  0.000215,  0.000156,  0.000209,   0.00016,  0.000215,  0.000139,  0.000124,  }, // 2
  {  0.000649,  0.000384,  0.000942,   0.00199,   0.00174,   0.00142,   0.00119,  0.000979,  0.000711,  0.000479,  0.000322,  0.000363,  0.000293,  0.000353,  0.000221,  0.000208,  }, // 3
  {   0.00094,    0.0004,   0.00079,   0.00174,   0.00312,   0.00298,   0.00221,   0.00181,   0.00145,   0.00109,  0.000684,  0.000709,  0.000447,  0.000604,  0.000371,    0.0004,  }, // 4
  {   0.00127,  0.000406,  0.000772,   0.00142,   0.00298,   0.00484,   0.00406,   0.00301,   0.00242,   0.00187,   0.00125,   0.00126,  0.000747,  0.000935,  0.000555,  0.000555,  }, // 5
  {   0.00155,  0.000293,  0.000655,   0.00119,   0.00221,   0.00406,    0.0056,   0.00475,   0.00361,   0.00264,   0.00193,   0.00205,  0.000986,   0.00118,  0.000641,  0.000742,  }, // 6
  {   0.00182,  0.000197,  0.000499,  0.000979,   0.00181,   0.00301,   0.00475,    0.0064,   0.00561,   0.00386,   0.00273,   0.00312,   0.00149,   0.00161,  0.000875,  0.000927,  }, // 7
  {   0.00201,  0.000129,  0.000308,  0.000711,   0.00145,   0.00242,   0.00361,   0.00561,   0.00781,   0.00614,   0.00412,   0.00459,    0.0022,     0.002,  0.000984,   0.00104,  }, // 8
  {   0.00287,  9.71e-05,  0.000215,  0.000479,   0.00109,   0.00187,   0.00264,   0.00386,   0.00614,   0.00882,    0.0066,   0.00694,   0.00342,   0.00288,    0.0013,   0.00149,  }, // 9
  {   0.00242,  7.53e-05,  0.000156,  0.000322,  0.000684,   0.00125,   0.00193,   0.00273,   0.00412,    0.0066,   0.00782,   0.00916,   0.00444,   0.00347,   0.00134,   0.00134,  }, // 10
  {   0.00383,  9.61e-05,  0.000209,  0.000363,  0.000709,   0.00126,   0.00205,   0.00312,   0.00459,   0.00694,   0.00916,    0.0211,    0.0128,   0.00962,   0.00279,   0.00248,  }, // 11
  {   0.00357,  7.35e-05,   0.00016,  0.000293,  0.000447,  0.000747,  0.000986,   0.00149,    0.0022,   0.00342,   0.00444,    0.0128,    0.0181,    0.0161,   0.00394,   0.00257,  }, // 12
  {   0.00629,  0.000107,  0.000215,  0.000353,  0.000604,  0.000935,   0.00118,   0.00161,     0.002,   0.00288,   0.00347,   0.00962,    0.0161,     0.044,    0.0161,   0.00597,  }, // 13
  {   0.00472,  6.53e-05,  0.000139,  0.000221,  0.000371,  0.000555,  0.000641,  0.000875,  0.000984,    0.0013,   0.00134,   0.00279,   0.00394,    0.0161,    0.0219,    0.0103,  }, // 14
  {   0.00734,  7.68e-05,  0.000124,  0.000208,    0.0004,  0.000555,  0.000742,  0.000927,   0.00104,   0.00149,   0.00134,   0.00248,   0.00257,   0.00597,    0.0103,    0.0361,  }, // 15
};

static double FreqMx_StrandDens[16][16] = {
  {    0.0546,    0.0161,   0.00195,   0.00078,  0.000332,  0.000195,   0.00016,  0.000112,  7.66e-05,  7.14e-05,  5.55e-05,  3.26e-05,  2.11e-05,   1.1e-05,  1.28e-06,  0.000551,  }, // 0
  {    0.0161,    0.0248,    0.0109,   0.00508,    0.0028,   0.00184,   0.00127,  0.000917,  0.000614,  0.000401,  0.000285,  0.000169,  9.27e-05,  5.47e-05,  2.52e-05,  0.000357,  }, // 1
  {   0.00195,    0.0109,    0.0148,    0.0108,   0.00685,   0.00472,   0.00335,   0.00238,   0.00161,    0.0011,  0.000709,  0.000398,   0.00022,  0.000103,  3.49e-05,  0.000315,  }, // 2
  {   0.00078,   0.00508,    0.0108,    0.0115,   0.00899,   0.00696,   0.00506,   0.00385,   0.00269,   0.00192,   0.00127,   0.00073,  0.000385,  0.000175,  5.11e-05,  0.000293,  }, // 3
  {  0.000332,    0.0028,   0.00685,   0.00899,   0.00955,   0.00831,   0.00692,   0.00531,   0.00391,   0.00278,   0.00184,   0.00109,  0.000553,  0.000204,  6.42e-05,  0.000257,  }, // 4
  {  0.000195,   0.00184,   0.00472,   0.00696,   0.00831,   0.00854,   0.00796,   0.00647,   0.00511,   0.00381,   0.00261,   0.00157,  0.000851,  0.000314,  0.000116,  0.000276,  }, // 5
  {   0.00016,   0.00127,   0.00335,   0.00506,   0.00692,   0.00796,   0.00843,   0.00756,   0.00638,   0.00496,   0.00356,   0.00225,   0.00118,  0.000501,  0.000183,  0.000296,  }, // 6
  {  0.000112,  0.000917,   0.00238,   0.00385,   0.00531,   0.00647,   0.00756,   0.00813,   0.00761,    0.0064,   0.00481,   0.00321,   0.00179,  0.000768,  0.000272,  0.000292,  }, // 7
  {  7.66e-05,  0.000614,   0.00161,   0.00269,   0.00391,   0.00511,   0.00638,   0.00761,   0.00832,   0.00766,   0.00646,   0.00464,   0.00271,   0.00127,  0.000469,  0.000339,  }, // 8
  {  7.14e-05,  0.000401,    0.0011,   0.00192,   0.00278,   0.00381,   0.00496,    0.0064,   0.00766,   0.00859,   0.00818,   0.00665,   0.00423,   0.00213,   0.00083,  0.000453,  }, // 9
  {  5.55e-05,  0.000285,  0.000709,   0.00127,   0.00184,   0.00261,   0.00356,   0.00481,   0.00646,   0.00818,    0.0096,   0.00913,   0.00676,   0.00364,   0.00163,  0.000732,  }, // 10
  {  3.26e-05,  0.000169,  0.000398,   0.00073,   0.00109,   0.00157,   0.00225,   0.00321,   0.00464,   0.00665,   0.00913,    0.0107,   0.00993,   0.00666,   0.00347,   0.00138,  }, // 11
  {  2.11e-05,  9.27e-05,   0.00022,  0.000385,  0.000553,  0.000851,   0.00118,   0.00179,   0.00271,   0.00423,   0.00676,   0.00993,    0.0126,     0.011,   0.00702,   0.00294,  }, // 12
  {   1.1e-05,  5.47e-05,  0.000103,  0.000175,  0.000204,  0.000314,  0.000501,  0.000768,   0.00127,   0.00213,   0.00364,   0.00666,     0.011,    0.0147,    0.0134,   0.00699,  }, // 13
  {  1.28e-06,  2.52e-05,  3.49e-05,  5.11e-05,  6.42e-05,  0.000116,  0.000183,  0.000272,  0.000469,   0.00083,   0.00163,   0.00347,   0.00702,    0.0134,    0.0185,    0.0159,  }, // 14
  {  0.000551,  0.000357,  0.000315,  0.000293,  0.000257,  0.000276,  0.000296,  0.000292,  0.000339,  0.000453,  0.000732,   0.00138,   0.00294,   0.00699,    0.0159,    0.0383,  }, // 15
};

static double FreqMx_NormDens[16][16] = {
  {    0.0485,    0.0178,   0.00784,     0.004,    0.0022,   0.00132,   0.00083,   0.00055,  0.000424,  0.000281,  0.000234,   0.00015,  0.000128,  9.07e-05,  8.53e-05,   0.00328,  }, // 0
  {    0.0178,    0.0208,    0.0135,   0.00761,   0.00442,   0.00264,   0.00161,   0.00106,  0.000706,  0.000493,  0.000404,  0.000287,  0.000199,  0.000156,  9.56e-05,  0.000797,  }, // 1
  {   0.00784,    0.0135,    0.0146,    0.0107,   0.00688,   0.00426,   0.00268,   0.00173,   0.00115,   0.00081,  0.000591,  0.000447,  0.000314,  0.000214,  0.000128,   0.00042,  }, // 2
  {     0.004,   0.00761,    0.0107,    0.0115,   0.00929,   0.00638,   0.00418,    0.0028,   0.00173,   0.00124,  0.000892,  0.000642,  0.000453,  0.000306,  0.000206,  0.000355,  }, // 3
  {    0.0022,   0.00442,   0.00688,   0.00929,   0.00986,   0.00855,   0.00605,   0.00425,   0.00285,   0.00193,   0.00136,   0.00094,  0.000642,  0.000429,  0.000283,   0.00028,  }, // 4
  {   0.00132,   0.00264,   0.00426,   0.00638,   0.00855,   0.00908,   0.00782,   0.00601,   0.00422,   0.00298,   0.00211,   0.00142,  0.000986,  0.000656,  0.000411,  0.000305,  }, // 5
  {   0.00083,   0.00161,   0.00268,   0.00418,   0.00605,   0.00782,   0.00854,   0.00771,   0.00594,   0.00434,   0.00303,   0.00203,   0.00142,  0.000904,  0.000545,  0.000365,  }, // 6
  {   0.00055,   0.00106,   0.00173,    0.0028,   0.00425,   0.00601,   0.00771,   0.00811,   0.00758,   0.00587,   0.00417,   0.00295,   0.00204,   0.00132,  0.000835,  0.000462,  }, // 7
  {  0.000424,  0.000706,   0.00115,   0.00173,   0.00285,   0.00422,   0.00594,   0.00758,   0.00832,   0.00766,   0.00596,   0.00437,   0.00295,   0.00193,   0.00121,  0.000636,  }, // 8
  {  0.000281,  0.000493,   0.00081,   0.00124,   0.00193,   0.00298,   0.00434,   0.00587,   0.00766,    0.0084,   0.00778,    0.0061,   0.00411,   0.00271,   0.00169,  0.000881,  }, // 9
  {  0.000234,  0.000404,  0.000591,  0.000892,   0.00136,   0.00211,   0.00303,   0.00417,   0.00596,   0.00778,   0.00867,   0.00832,   0.00613,   0.00419,   0.00252,   0.00131,  }, // 10
  {   0.00015,  0.000287,  0.000447,  0.000642,   0.00094,   0.00142,   0.00203,   0.00295,   0.00437,    0.0061,   0.00832,   0.00966,   0.00877,    0.0064,   0.00397,   0.00202,  }, // 11
  {  0.000128,  0.000199,  0.000314,  0.000453,  0.000642,  0.000986,   0.00142,   0.00204,   0.00295,   0.00411,   0.00613,   0.00877,    0.0106,    0.0098,   0.00654,   0.00337,  }, // 12
  {  9.07e-05,  0.000156,  0.000214,  0.000306,  0.000429,  0.000656,  0.000904,   0.00132,   0.00193,   0.00271,   0.00419,    0.0064,    0.0098,    0.0129,    0.0114,   0.00592,  }, // 13
  {  8.53e-05,  9.56e-05,  0.000128,  0.000206,  0.000283,  0.000411,  0.000545,  0.000835,   0.00121,   0.00169,   0.00252,   0.00397,   0.00654,    0.0114,    0.0173,    0.0124,  }, // 14
  {   0.00328,  0.000797,   0.00042,  0.000355,   0.00028,  0.000305,  0.000365,  0.000462,  0.000636,  0.000881,   0.00131,   0.00202,   0.00337,   0.00592,    0.0124,    0.0349,  }, // 15
};

float *g_FeatureFreqsVec[FEATURE_COUNT];
vector<vector<float> > g_FeatureFreqsMxVec[FEATURE_COUNT];

static bool Init()
	{
#define f(x, n)	g_FeatureFreqsVec[FEATURE_##x] = Freqs_##x; \
	g_FeatureFreqsMxVec[FEATURE_##x].resize(n); \
	for (uint i = 0; i < n; ++i) { g_FeatureFreqsMxVec[FEATURE_##x][i].resize(n); \
		for (uint j = 0; j < n; ++j) \
			g_FeatureFreqsMxVec[FEATURE_##x][i][j] = (float) FreqMx_##x[i][j]; }

	f(AA, 20);
	f(NbrDist, 16);
	f(MySS, 16);
	f(NbrMySS, 16);
	f(RevNbrDist, 16);
	f(DstNxtHlx, 16);
	f(StrandDens, 16);
	f(NormDens, 16);

#undef f
	return true;
	}
static bool InitDone = Init();
