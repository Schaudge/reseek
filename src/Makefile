########################################################
# Makefile is generated by ./build_linux.py
# Don't edit the Makefile -- update the generator script
########################################################

BINDIR := ../bin
OBJDIR := o
BINPATH := $(BINDIR)/reseek

CC = gcc
CFLAGS := $(CFLAGS) -O3 -ffast-math -march=native

CXX = g++
CXXFLAGS := $(CFLAGS) -DNDEBUG -pthread -O3 -ffast-math -march=native --std=c++17

UNAME_S := $(shell uname -s)
LDFLAGS := $(LDFLAGS) -pthread -lpthread
ifeq ($(UNAME_S),Linux)
    LDFLAGS += -static
endif

HDRS = \
  abcxyz.h \
  active.h \
  alpha.h \
  bcadata.h \
  best.h \
  binner.h \
  calibratesearcher.h \
  calibratesearcher2.h \
  chainreader2.h \
  cigar.h \
  cigar_template.h \
  cmds.h \
  combomx.h \
  counters.h \
  crc32.h \
  daliscorer.h \
  dbsearcher.h \
  deflate.h \
  derepper.h \
  distmxsearcher.h \
  dss.h \
  dssaligner.h \
  dssp.h \
  dssparams.h \
  fast_erf.h \
  fastaseqsource.h \
  featurelist.h \
  features.h \
  fileseqsource.h \
  filler.h \
  floatfeatures.h \
  getticks.h \
  gobuff.h \
  gzguts.h \
  inffast.h \
  inffixed.h \
  inflate.h \
  inftrees.h \
  intfeatures.h \
  linereader.h \
  linereader2.h \
  lockobj.h \
  lockobjs.h \
  logodds.h \
  megacluster.h \
  murmur.h \
  mx.h \
  myopts.h \
  myutils.h \
  obj.h \
  objmgr.h \
  objtype.h \
  objtypes.h \
  omplock.h \
  parasail.h \
  pathinfo.h \
  pdbchain.h \
  pdbfilescanner.h \
  profileloader.h \
  quarts.h \
  scalarparams.h \
  scop40bench.h \
  seqdb.h \
  seqinfo.h \
  seqsource.h \
  sfasta.h \
  sort.h \
  spher.h \
  sweeper.h \
  swtrace.h \
  timers.h \
  timing.h \
  tracebit.h \
  trainer.h \
  trees.h \
  usage.h \
  userfieldnames.h \
  userfields.h \
  xdpmem.h \
  zconf.h \
  zlib.h \
  zutil.h \

OBJS = \
  $(OBJDIR)/abcxyz.o \
  $(OBJDIR)/adjust.o \
  $(OBJDIR)/alpha.o \
  $(OBJDIR)/alpha2.o \
  $(OBJDIR)/b62.o \
  $(OBJDIR)/bcadata.o \
  $(OBJDIR)/blosum.o \
  $(OBJDIR)/blosum62.o \
  $(OBJDIR)/calibrate.o \
  $(OBJDIR)/calibrate2.o \
  $(OBJDIR)/calibrate3.o \
  $(OBJDIR)/calibrate4.o \
  $(OBJDIR)/calibratesearcher.o \
  $(OBJDIR)/chainreader2.o \
  $(OBJDIR)/cif.o \
  $(OBJDIR)/cigar.o \
  $(OBJDIR)/cluster.o \
  $(OBJDIR)/convert.o \
  $(OBJDIR)/daliscorer.o \
  $(OBJDIR)/daliscore_msas2.o \
  $(OBJDIR)/daliscore_msa.o \
  $(OBJDIR)/daliscore_msas.o \
  $(OBJDIR)/daliscore_tsv.o \
  $(OBJDIR)/distmx.o \
  $(OBJDIR)/evalue_report.o \
  $(OBJDIR)/explore1.o \
  $(OBJDIR)/mu_mapping.o \
  $(OBJDIR)/profileloader.o \
  $(OBJDIR)/md5.o \
  $(OBJDIR)/pdbchaincal.o \
  $(OBJDIR)/pdbfilescanner.o \
  $(OBJDIR)/gumbel.o \
  $(OBJDIR)/gzipfileio.o \
  $(OBJDIR)/linereader2.o \
  $(OBJDIR)/parasail.o \
  $(OBJDIR)/parasail_cigar.o \
  $(OBJDIR)/parasail_combo.o \
  $(OBJDIR)/pdb2mega.o \
  $(OBJDIR)/readhits.o \
  $(OBJDIR)/runquery.o \
  $(OBJDIR)/runself.o \
  $(OBJDIR)/runthreads.o \
  $(OBJDIR)/scop40bit.o \
  $(OBJDIR)/search.o \
  $(OBJDIR)/combomx.o \
  $(OBJDIR)/combomx_data.o \
  $(OBJDIR)/dali.o \
  $(OBJDIR)/dbsearcher.o \
  $(OBJDIR)/derepper.o \
  $(OBJDIR)/dss.o \
  $(OBJDIR)/dssaligner.o \
  $(OBJDIR)/dssparams.o \
  $(OBJDIR)/features.o \
  $(OBJDIR)/float_feature_bins.o \
  $(OBJDIR)/getbins.o \
  $(OBJDIR)/gsw.o \
  $(OBJDIR)/jiggle.o \
  $(OBJDIR)/kabsch.o \
  $(OBJDIR)/kmer_eval.o \
  $(OBJDIR)/kmer_eval2.o \
  $(OBJDIR)/logaln.o \
  $(OBJDIR)/logodds.o \
  $(OBJDIR)/mergefwdback.o \
  $(OBJDIR)/msa2cmp.o \
  $(OBJDIR)/murmurhash.o \
  $(OBJDIR)/myss.o \
  $(OBJDIR)/namedparams.o \
  $(OBJDIR)/prettyaln.o \
  $(OBJDIR)/scalar_sweep.o \
  $(OBJDIR)/scop40bench.o \
  $(OBJDIR)/scop40benchroc.o \
  $(OBJDIR)/scoremxs2.o \
  $(OBJDIR)/sweeper.o \
  $(OBJDIR)/swfastpinop.o \
  $(OBJDIR)/swfastpinopgapless.o \
  $(OBJDIR)/swgapless.o \
  $(OBJDIR)/swgaplessint.o \
  $(OBJDIR)/swgaplessprof.o \
  $(OBJDIR)/swgaplessprofb.o \
  $(OBJDIR)/testmodel.o \
  $(OBJDIR)/testmodel2.o \
  $(OBJDIR)/test_para.o \
  $(OBJDIR)/test_para_cal.o \
  $(OBJDIR)/test_para_path.o \
  $(OBJDIR)/test_xdrop.o \
  $(OBJDIR)/timing.o \
  $(OBJDIR)/trained_features.o \
  $(OBJDIR)/train_features.o \
  $(OBJDIR)/userfields.o \
  $(OBJDIR)/usort.o \
  $(OBJDIR)/valuetoint.o \
  $(OBJDIR)/one2three.o \
  $(OBJDIR)/fastaseqsource.o \
  $(OBJDIR)/fileseqsource.o \
  $(OBJDIR)/getss.o \
  $(OBJDIR)/sscluster.o \
  $(OBJDIR)/trainer.o \
  $(OBJDIR)/usage.o \
  $(OBJDIR)/linereader.o \
  $(OBJDIR)/lockobj.o \
  $(OBJDIR)/mx.o \
  $(OBJDIR)/myutils.o \
  $(OBJDIR)/objmgr.o \
  $(OBJDIR)/reseek_main.o \
  $(OBJDIR)/readchains.o \
  $(OBJDIR)/pdbchain.o \
  $(OBJDIR)/quarts.o \
  $(OBJDIR)/spher.o \
  $(OBJDIR)/sw.o \
  $(OBJDIR)/seqdb.o \
  $(OBJDIR)/seqinfo.o \
  $(OBJDIR)/seqsource.o \
  $(OBJDIR)/sfasta.o \
  $(OBJDIR)/sort.o \
  $(OBJDIR)/xdropbwd.o \
  $(OBJDIR)/xdropfwd.o \
  $(OBJDIR)/adler32.o \
  $(OBJDIR)/crc32.o \
  $(OBJDIR)/deflate.o \
  $(OBJDIR)/gzlib.o \
  $(OBJDIR)/gzread.o \
  $(OBJDIR)/infback.o \
  $(OBJDIR)/inffast.o \
  $(OBJDIR)/inflate.o \
  $(OBJDIR)/inftrees.o \
  $(OBJDIR)/trees.o \
  $(OBJDIR)/zutil.o \

.PHONY: clean

$(BINPATH) : $(BINDIR)/ $(OBJDIR)/ $(OBJS)
	$(CXX) $(LDFLAGS) $(OBJS) -o $(BINPATH)
	strip $(BINPATH)

$(OBJDIR)/ :
	mkdir -p $(OBJDIR)/

$(BINDIR)/ :
	mkdir -p $(BINDIR)/

$(OBJDIR)/%.o : %.c $(HDRS)
	$(CC) $(CPPFLAGS) $(CFLAGS) -c -o $@ $<

$(OBJDIR)/%.o : %.cpp $(HDRS)
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -c -o $@ $<

clean:
	rm -rf $(OBJDIR)/ $(BINPATH)
